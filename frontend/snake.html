<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Game Ular Klasik</title>
    <link rel="stylesheet" href="style.css">
    <style>
        #gameContainerSnake {
            background-color: #333; /* Warna latar belakang gelap untuk kesan klasik */
            border-radius: 15px;
            padding: 10px;
            user-select: none; 
            -webkit-user-select: none;
        }
        #snakeInstructions {
            color: #eee; /* Warna teks lebih terang */
            font-size: 1.1em;
            margin-bottom: 15px;
        }
        #snakeResult {
            display: none; 
            margin-top: 20px;
        }
        #snakeCanvas {
            border: 2px solid #fff; /* Tambahkan border putih untuk kanvas */
        }
    </style>
</head>
<body>

<div class="container">
    <h1 style="color: #66ff66;">Game Terakhir: Ular Klasik!</h1>
    <p style="color: #eee;">Gunakan tombol panah atau W/A/S/D untuk bergerak.</p>
    <p id="snakeInstructions">Ayo kumpulkan semua hadiahnya!</p>
    <div id="gameContainerSnake">
        <canvas id="snakeCanvas"></canvas>
    </div>
    <div id="snakeResult">
        <h2 id="resultTitleSnake"></h2>
        <p>Skor Akhir: <span id="finalScoreSnake"></span></p>
        <button id="nextButtonSnake">Lihat Hasil Akhir!</button>
    </div>
</div>


<script>
    const canvas = document.getElementById('snakeCanvas');
    const ctx = canvas.getContext('2d');

    const tileSize = 20; // Ukuran setiap kotak ular
    canvas.width = 25 * tileSize; // Lebar canvas (500px)
    canvas.height = 25 * tileSize; // Tinggi canvas (500px)

    // --- PENGATURAN GAME ---
    let snake = [ 
        { x: 12 * tileSize, y: 12 * tileSize }, // Posisi awal ular
        { x: 11 * tileSize, y: 12 * tileSize },
        { x: 10 * tileSize, y: 12 * tileSize }
    ];
    let food = { x: 0, y: 0 };
    let dx = tileSize; // Arah awal ke kanan
    let dy = 0;
    let score = 0;
    let gameOver = false;
    let changingDirection = false; // Untuk mencegah belok cepat ganda
    const gameSpeed = 150; // milliseconds, makin kecil makin cepat

    // --- FUNGSI UTAMA GAME ---

    function generateFood() {
        food.x = Math.floor(Math.random() * (canvas.width / tileSize)) * tileSize;
        food.y = Math.floor(Math.random() * (canvas.height / tileSize)) * tileSize;

        // Pastikan makanan tidak muncul di atas ular
        for (let i = 0; i < snake.length; i++) {
            if (food.x === snake[i].x && food.y === snake[i].y) {
                generateFood(); // Ulangi jika tumpang tindih
            }
        }
    }

    // --- KONTROL PEMAIN ---
    window.addEventListener('keydown', (e) => {
        if (changingDirection) return;
        changingDirection = true;

        e.preventDefault(); // Mencegah scroll halaman
        const keyPressed = e.key;
        
        const goingUp = dy === -tileSize;
        const goingDown = dy === tileSize;
        const goingLeft = dx === -tileSize;
        const goingRight = dx === tileSize;

        if ((keyPressed === 'ArrowLeft' || keyPressed === 'a') && !goingRight) {
            dx = -tileSize; dy = 0;
        }
        if ((keyPressed === 'ArrowUp' || keyPressed === 'w') && !goingDown) {
            dx = 0; dy = -tileSize;
        }
        if ((keyPressed === 'ArrowRight' || keyPressed === 'd') && !goingLeft) {
            dx = tileSize; dy = 0;
        }
        if ((keyPressed === 'ArrowDown' || keyPressed === 's') && !goingUp) {
            dx = 0; dy = tileSize;
        }
    });
    
    function showResultSnake() {
        document.getElementById('gameContainerSnake').style.display = 'none';
        document.getElementById('snakeResult').style.display = 'block';
        document.getElementById('resultTitleSnake').textContent = "Game Selesai!";
        document.getElementById('finalScoreSnake').textContent = score;
        document.getElementById('nextButtonSnake').onclick = () => {
            // Arahkan ke halaman pertanyaan pertama
            window.location.href = 'ask_cia.html';
        };
    }

    function drawSnakePart(snakePart, isHead = false) {
        if (isHead) {
            ctx.fillStyle = '#ff69b4'; // Warna kepala pink
            ctx.strokeStyle = '#fff'; // Border putih
        } else {
            ctx.fillStyle = '#66ff66'; // Warna badan hijau terang
            ctx.strokeStyle = '#fff'; // Border putih
        }
        ctx.fillRect(snakePart.x, snakePart.y, tileSize, tileSize);
        ctx.strokeRect(snakePart.x, snakePart.y, tileSize, tileSize);
    }

    function drawFood() {
        ctx.fillStyle = '#ff0000'; // Makanan warna merah
        ctx.strokeStyle = '#fff';
        ctx.fillRect(food.x, food.y, tileSize, tileSize);
        ctx.strokeRect(food.x, food.y, tileSize, tileSize);
    }

    function checkCollision() {
        // Tabrak diri sendiri
        for (let i = 4; i < snake.length; i++) {
            if (snake[i].x === snake[0].x && snake[i].y === snake[0].y) return true;
        }
        // Tabrak dinding
        const hitLeftWall = snake[0].x < 0;
        const hitRightWall = snake[0].x >= canvas.width;
        const hitTopWall = snake[0].y < 0;
        const hitBottomWall = snake[0].y >= canvas.height;
        
        return hitLeftWall || hitRightWall || hitTopWall || hitBottomWall;
    }

    function gameLoop() {
        if (gameOver) {
            showResultSnake();
            return;
        }

        changingDirection = false; // Reset status belok

        setTimeout(() => {
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Bersihkan canvas

            drawFood(); // Gambar makanan

            // Pindahkan ular
            const head = { x: snake[0].x + dx, y: snake[0].y + dy };
            snake.unshift(head); // Tambahkan kepala baru

            const didEatFood = head.x === food.x && head.y === food.y;
            if (didEatFood) {
                score++;
                generateFood(); // Buat makanan baru
            } else {
                snake.pop(); // Hapus bagian ekor jika tidak makan
            }

            if (checkCollision()) {
                gameOver = true;
                return;
            }
            
            // Gambar semua bagian ular
            snake.forEach((segment, index) => {
                drawSnakePart(segment, index === 0); // Bagian pertama adalah kepala
            });

            gameLoop(); // Panggil loop selanjutnya
        }, gameSpeed);
    }

    // --- MULAI GAME ---
    generateFood(); // Buat makanan pertama
    gameLoop(); // Mulai game loop
</script>
</body>
</html>