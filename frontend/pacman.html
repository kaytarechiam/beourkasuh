<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Cinnamoroll Man</title>
    <link rel="stylesheet" href="style.css">
    <style>
        #gameContainerPacman {
            background-color: #000;
            border-radius: 15px;
            padding: 10px;
        }
        #pacmanInstructions {
            color: white;
            font-size: 1.2em;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Game Kedua: Cinnamoroll-Man!</h1>
    <p id="pacmanInstructions">Hayoo dikejarr desuuuuh</p>
    <div id="gameContainerPacman">
        <canvas id="pacmanCanvas"></canvas>
    </div>
    <div id="pacmanResult" style="display: none; margin-top: 20px;">
        <h2 id="resultTitle"></h2>
        <p id="resultMessage"></p>
        <button id="nextButton">Lanjut ke Game Terakhir</button>
    </div>
</div>


<script>
    const canvas = document.getElementById('pacmanCanvas');
    const ctx = canvas.getContext('2d');

    const tileSize = 32;
    canvas.width = 15 * tileSize;
    canvas.height = 17 * tileSize;

    // Aset Gambar
    const playerImg = new Image();
    playerImg.src = 'cinnamoroll_player.png'; 

    const ghost1Img = new Image();
    ghost1Img.src = 'ciw_ghost.png'; 

    const ghost2Img = new Image();
    ghost2Img.src = 'kei_ghost.png'; 

    // Peta Game
    const map = [
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,2,2,2,2,2,2,1,2,2,2,2,2,2,1],
        [1,3,1,2,1,1,2,1,2,1,1,2,1,3,1],
        [1,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
        [1,2,1,1,2,1,1,1,1,1,2,1,1,2,1],
        [1,2,2,2,2,2,2,1,2,2,2,2,2,2,1],
        [1,1,1,2,1,1,0,0,0,1,1,2,1,1,1],
        [0,0,1,2,1,0,0,0,0,0,1,2,1,0,0],
        [1,1,1,2,1,1,1,1,1,1,1,2,1,1,1],
        [1,2,2,2,2,2,2,1,2,2,2,2,2,2,1],
        [1,3,1,2,1,1,2,1,2,1,1,2,1,3,1],
        [1,2,2,2,1,1,2,2,2,1,1,2,2,2,1],
        [1,2,1,2,2,2,2,1,2,2,2,2,1,2,1],
        [1,2,1,1,1,1,2,1,2,1,1,1,1,2,1],
        [1,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ];

    let player = { x: 7 * tileSize, y: 12 * tileSize, dx: 0, dy: 0, speed: 2 };
    let ghosts = [
        { x: 6 * tileSize, y: 7 * tileSize, dx: 0, dy: -2, speed: 2, img: ghost1Img },
        { x: 8 * tileSize, y: 7 * tileSize, dx: 0, dy: -2, speed: 2, img: ghost2Img }
    ];

    let score = 0;
    let totalCoins = 0;
    map.forEach(row => row.forEach(tile => { if (tile === 2) totalCoins++; }));

    // --- KONTROL PEMAIN (INI BAGIAN YANG DIPERBAIKI) ---
    // Fungsi ini akan "mendengarkan" tombol keyboard yang ditekan
    window.addEventListener('keydown', (e) => {
        // Mencegah scroll halaman saat menekan panah
        e.preventDefault(); 
        
        switch(e.key) {
            case 'ArrowUp':
            case 'w':
                player.dx = 0;
                player.dy = -player.speed;
                break;
            case 'ArrowDown':
            case 's':
                player.dx = 0;
                player.dy = player.speed;
                break;
            case 'ArrowLeft':
            case 'a':
                player.dx = -player.speed;
                player.dy = 0;
                break;
            case 'ArrowRight':
            case 'd':
                player.dx = player.speed;
                player.dy = 0;
                break;
        }
    });


    function checkCollision(x, y) {
        if (x < 0 || x >= canvas.width || y < 0 || y >= canvas.height) return true;
        const col = Math.floor(x / tileSize);
        const row = Math.floor(y / tileSize);
        return map[row] && map[row][col] === 1;
    }
    
    function showResult(isWin) {
        // ... (kode showResult tidak berubah)
    }

    function gameLoop() {
        // ... (kode gameLoop tidak berubah)
    }
    
    // ... (kode pemuatan gambar tidak berubah)

</script>

</body>
</html>